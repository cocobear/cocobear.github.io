title: linux下上网加速 解决网通与电信之间的访问
tags:
  - Linux
  - online
id: 29
categories:
  - Linux
date: 2007-04-06 19:17:43
---

Friday, 15\. December 2006, 09:18:06

前几天看到有同学使用"豫通网关"这个东西来上网，去google搜了一下，原来是一个解决网通与电信之间访问瓶颈的问题的软件，类似的软件有：

豫通网关，统一网关，黑鹰加速器，千渡互联等一堆。

前几天看到有同学使用"豫通网关"这个东西来上网，去google搜了一下，原来是一个解决网通与电信之间访问瓶颈的问题的软件，类似的软件有：

豫通网关，统一网关，黑鹰加速器，千渡互联等一堆。

上网搜了一下关于这类软件加速的原理，其实是利用了一个叫VPN（Virtal Private Network）技术，用户访问网络的时候先通过VPN拨号连接到到VPN的服务器上（服务器是网通电信双信的，或者更多线），然后利用VPN服务器的网通（或者电信）专线连接到用户请求的IP。

原理：
_　　　　　透过VPN拨号　　　　　　　透过VPN服务器的网通专线
电信用户———————→VPN服务器————————————→网通网络_

_　　　　　透过VPN拨号　　　　　　　透过VPN服务器的电信专线
网通用户———————→VPN服务器————————————→电信网络
_

[参考文章](http://www.txwm.com/News/netbarsystem/200605/2006051015101141530.shtml)

了解了原理，如果知道了服务器的IP与用户密码就可以利用windows自带的VPN拨号工具来直接连接，不需要用他们提供的软件了。
于是创建一个网络连接，然后设置连接到VPN服务器上，填入IP，用户名，密码，马上就连接上去了（可能要开启一些windows服务）。后来在黑鹰的论坛里看到了介绍手动创建连接的方法，呵呵，原来本来就是可以的，偶还以为发现新大陆了。

windows下的问题解决了，但偶自己用的是linux，如何在linux利用他们的服务器来加速呢？效仿windows下创建一个vpn连接，但是linux没有自带的vpn连接工具（至少在fc5里没有），还是google一下吧。

搜到一个叫pptp的软件：[pptp](http://pptpclient.sourceforge.net)这是它是项目地址。

根据上面地址的介绍很顺利的在机子上装上了pptp以及pptpconfig GUI，接下来还是根据上面介绍连接到服务器：

点击Server标签，填入一下各项：

	Name: 新建连接的名字,这个随便你

	Server: VPN服务器的IP地址，就是类似www.1000du.net这类加速网站的服务器地址（注意一下，看你是网通还是电信添相应的地址）

	Domain: 这个一般不需要

	User Name: 登录到VPN的用户名，网站上公开的

	Password: 你的VPN拨号密码，同上

这里是我现在用的：


	Server:221.11.70.115
	User Name:zlnic.net
	Password:1000du


![](http://files.myopera.com/cocobear/blog/Screenshot.png)

接下来的设置很关键,没设置的话,你的VPN连接上了也没效果,
点击Routing标签, 选择All to Tunnel,这样所有的连接都通过VPN服务器了，当然你也可以选择Client to LAN这一项，然后在右边的填写你想通过VPN服务器访问的路由表，也就是电信的网段（偶是网通的，这里填电信的，你如果是电信那就要添网通的了哦）
点击DNS标签，去掉Automatic, 并空置下面两栏不填；
OK,这样就设置完了,你可以在服务器列表你双击或者通过鼠标右键你的"start"启动这个VPN连接,启动以后可以把窗口关掉,不会影响你的连接!

一般这些服务器都有512K的限速，所以如果你是1M或者更快的网速就不要选择All to Tunnel，选择Client to LAN 这一项，自己添加由路表，这样可以访问网通时就直接连接，访问电信时才通过VPN服务器。

手动添加所有的路由表太麻烦了，可以写一个脚本，当VPN连接好后，运行这个脚本自动添加路由表。

添加网关到路由表：


	route add -net 192.168.0.0 gw 221.11.2.1 netmask 255.255.0.0 ppp1

192.168.0.0:目标地址，你要访问的目标，如果前面是-net那么这里就是一个网络，如果前面是-host，这里就是一个ip。

gw 221.11.2.1:网关，连接后你会看到路由表里多了一个网关，这里就添这个了，也就是连接vpn服务器后它给你提示的地址。

netmask 255.255.0.0:子网掩码，根据前面的-net 或者-host填写。例如你如果想让所有192.168.0.0网络的所有IP全部通过vpn服务器，那么子网掩码就填为：255.255.0.0。

ppp1:一般连接vpn服务器后会多一个ppp1，这里就填这个。
![](http://files.myopera.com/cocobear/blog/1Screenshot-1.png)

61.145.0.0/24是我选择的自动填加的路由表

10.10.0.1是连接vpn后自动添加的网关

192.168.0.0是上面命令的效果（只是个例子，没有实际意义）